# 新プロジェクト構築ガイド

このガイドは、テンプレートプロジェクトから新規プロジェクトを作成し、運用を開始するまでの全手順を説明します。

## クイックスタート

対話形式でプロジェクトを作成できます：

```
/new-project
```

すべての設定を対話形式で進め、必要なファイルを自動生成します。
不要な項目は「スキップ」を選択することで省略できます。

---

## 全体フロー

```
┌─────────────────────────────────────────────────────────────┐
│  1. プロジェクト作成（GitHub Template機能）                    │
└─────────────────────────────────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────┐
│  2. 仕様決定フェーズ（AIと対話して決定）                        │
│     - 機能要件 / 非機能要件 / 技術選定                         │
└─────────────────────────────────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────┐
│  3. プロジェクト固有設定（規約・ルール決定）                    │
│     - コーディング規約 / テスト規約 / Git運用ルール             │
└─────────────────────────────────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────┐
│  4. 環境構築（Docker / ローカル）                             │
│     - 開発環境セットアップ                                    │
└─────────────────────────────────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────┐
│  5. CI/CD設定                                                │
│     - 自動テスト / ビルド / デプロイ                           │
└─────────────────────────────────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────┐
│  6. セキュリティ設定                                          │
│     - 認証情報管理 / シークレット管理                          │
└─────────────────────────────────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────┐
│  7. Confluence連携（情報の一元管理）                          │
│     - スペース作成 / 標準フォルダ構成 / ドキュメント            │
└─────────────────────────────────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────┐
│  8. 開発開始                                                 │
└─────────────────────────────────────────────────────────────┘
```

### プロジェクト種別による必要項目

| 設定項目 | Webアプリ | API | バッチ | PoC |
|---------|:---------:|:---:|:------:|:---:|
| 1. プロジェクト作成 | ● | ● | ● | ● |
| 2. 仕様決定 | ● | ● | ● | ○ |
| 3. プロジェクト固有設定 | ● | ● | ● | ○ |
| 4. 環境構築 | ● | ● | ● | ○ |
| 5. CI/CD設定 | ● | ● | ○ | × |
| 6. セキュリティ設定 | ● | ● | ○ | × |
| 7. Confluence連携 | ● | ● | ○ | × |

**凡例**: ● 必須 / ○ 推奨 / × 不要

---

## 1. プロジェクト作成（GitHub Template機能）

### 前提条件

- テンプレートリポジトリがGitHubにPush済み
- テンプレートリポジトリの設定で「Template repository」が有効

### 手順

#### 1.1 GitHubでテンプレートリポジトリを設定（初回のみ）

1. GitHubでテンプレートリポジトリを開く
2. Settings → General → Template repository にチェック
3. Save

#### 1.2 新規プロジェクト作成

1. テンプレートリポジトリのページで「**Use this template**」ボタンをクリック
2. 「Create a new repository」を選択
3. 必要情報を入力：
   - Repository name: プロジェクト名
   - Description: プロジェクトの説明
   - Public / Private: 適切なものを選択
4. 「Create repository」をクリック

#### 1.3 ローカルにクローン

```bash
git clone https://github.com/<username>/<new-project>.git
cd <new-project>
```

#### 1.4 初期設定

```bash
# CLAUDE.mdをプロジェクト用にリネーム（テンプレート用の内容を置き換え）
# プロジェクト固有の内容に編集する
```

---

## 2. 仕様決定フェーズ

AIとの対話を通じて、プロジェクトの仕様を決定していきます。

### 2.1 仕様決定の進め方

以下のコマンドで仕様決定セッションを開始できます：

```
/agent-doc-manager プロジェクトの仕様を決定していきたいです
```

### 2.2 決定すべき項目

#### 機能要件

| 項目 | 内容 | 決定状況 |
|------|------|----------|
| 主要機能 | システムの核となる機能 | □ |
| サブ機能 | 補助的な機能 | □ |
| 画面一覧 | 必要な画面の洗い出し | □ |
| API一覧 | 必要なAPIエンドポイント | □ |
| ユースケース | ユーザーの利用シナリオ | □ |

#### 非機能要件

| 項目 | 内容 | 決定状況 |
|------|------|----------|
| 性能要件 | レスポンスタイム、スループット | □ |
| 可用性 | 稼働率、障害対応 | □ |
| セキュリティ | 認証・認可、データ保護 | □ |
| 拡張性 | 将来の拡張予定 | □ |
| 運用・保守 | 監視、ログ、バックアップ | □ |

#### 技術選定

| 項目 | 選択肢例 | 決定 |
|------|----------|------|
| フロントエンド | React / Vue / Next.js / Nuxt | |
| バックエンド | Node.js / Python / Go / Java | |
| データベース | PostgreSQL / MySQL / MongoDB | |
| インフラ | AWS / GCP / Azure / オンプレ | |
| CI/CD | GitHub Actions / GitLab CI / Jenkins | |

### 2.3 仕様決定の記録

決定事項は以下に記録します：

```
.claude/docs/design/
├── requirements.md          # 要件定義
├── technical-decisions.md   # 技術選定記録
└── discussion-log.md        # 検討履歴
```

---

## 3. プロジェクト固有設定

### 3.1 コーディング規約

プロジェクトのコーディング規約を決定します。

```
/agent-dev-code このプロジェクトのコーディング規約を決めたいです
```

#### 決定項目

| 項目 | 内容 | 決定状況 |
|------|------|----------|
| 命名規則 | 変数、関数、クラス、ファイル名 | □ |
| フォーマット | インデント、行長、括弧位置 | □ |
| コメント | ドキュメンテーションコメント形式 | □ |
| ディレクトリ構成 | src配下の構成 | □ |
| インポート順序 | インポート文の順序ルール | □ |

### 3.2 テスト規約

```
/agent-test-manager このプロジェクトのテスト規約を決めたいです
```

#### 決定項目

| 項目 | 内容 | 決定状況 |
|------|------|----------|
| テストフレームワーク | Jest / pytest / JUnit等 | □ |
| カバレッジ基準 | 最低カバレッジ率 | □ |
| テストファイル配置 | tests/ or __tests__ 等 | □ |
| 命名規則 | テストケースの命名 | □ |
| モック方針 | 外部依存のモック方法 | □ |

### 3.3 Git運用ルール

```
/agent-infra-git このプロジェクトのGit運用ルールを決めたいです
```

#### 決定項目

| 項目 | 内容 | 決定状況 |
|------|------|----------|
| ブランチ戦略 | Git Flow / GitHub Flow等 | □ |
| コミットメッセージ | Conventional Commits等 | □ |
| PRルール | レビュアー数、マージ条件 | □ |
| リリースフロー | タグ付け、バージョニング | □ |

### 3.4 規約の保存先

```
.claude/skills/
├── coding-standards.md      # コーディング規約（カスタマイズ）
├── test-conventions.md      # テスト規約（カスタマイズ）
└── commit-message.md        # コミットメッセージ規約（カスタマイズ）
```

---

## 4. 環境構築

開発環境を構築します。Docker環境またはローカル環境を選択できます。

### 4.1 環境構築方法の選択

```
/setup-docker       # Docker環境を構築
```

または対話形式で選択：

```
AI: 【質問】開発環境の構築方法を選択してください。

    1. Docker（推奨）
    2. ローカル環境
    3. 両方のドキュメントを用意
    0. スキップ（後で設定 / 不要）
```

### 4.2 Docker環境構築

#### 対話で決定する項目

| 項目 | 選択肢例 |
|------|----------|
| サービス構成 | Webアプリ+DB / +Redis / カスタム |
| データベース | PostgreSQL / MySQL / MongoDB |
| ベースイメージ | Node.js / PHP / Python / Java |
| ポート設定 | 使用するポート番号 |

#### 生成されるファイル

```
{project}/
├── docker/
│   ├── app/
│   │   └── Dockerfile
│   ├── web/
│   │   ├── nginx.conf
│   │   └── default.conf
│   └── db/
│       └── my.cnf (または postgresql.conf)
├── docker-compose.yml
└── .env.docker.example
```

#### 起動手順

```bash
cp .env.docker.example .env
docker compose up -d
```

### 4.3 ローカル環境構築

Docker以外の環境構築手順を記載します。

#### 生成されるファイル

```
docs/setup/
├── README.md           # 概要と選択ガイド
├── local-setup.md      # ローカル環境構築手順
└── troubleshooting.md  # よくある問題と解決策
```

---

## 5. CI/CD設定

継続的インテグレーション/デプロイを設定します。

### 5.1 CI/CD設定の開始

```
/setup-cicd         # CI/CD設定を構築
```

### 5.2 設定項目

| 項目 | 内容 |
|------|------|
| ワークフロー定義 | GitHub Actions / GitLab CI 等 |
| 自動テスト | プッシュ・PR時のテスト実行 |
| コード品質チェック | Linter / Formatter 自動実行 |
| ビルド | 自動ビルド、成果物保存 |
| デプロイ | 環境別（dev/stg/prod）デプロイ |
| 通知 | Slack/Teams への結果通知 |
| セキュリティスキャン | 依存関係の脆弱性チェック |

### 5.3 GitHub Actions構成例

#### 生成されるファイル

```
.github/
└── workflows/
    ├── ci.yml           # テスト・Lint
    ├── build.yml        # ビルド
    └── deploy.yml       # デプロイ（環境別）
```

#### ci.yml 例

```yaml
name: CI

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup
        uses: actions/setup-node@v4
        with:
          node-version: '20'
      - name: Install dependencies
        run: npm ci
      - name: Run tests
        run: npm test
      - name: Run linter
        run: npm run lint
```

### 5.4 対話で決定する項目

| 項目 | 選択肢例 |
|------|----------|
| CIツール | GitHub Actions / GitLab CI / Jenkins |
| テスト実行タイミング | push / PR / 両方 |
| デプロイ対象環境 | dev / stg / prod |
| 通知先 | Slack / Teams / なし |

---

## 6. セキュリティ設定

認証情報とシークレットの管理方法を設定します。

### 6.1 セキュリティ設定の開始

```
/setup-security     # セキュリティ設定を構築
```

### 6.2 設定項目

| 項目 | 内容 |
|------|------|
| 環境変数管理 | .env ファイルの構成 |
| シークレット管理 | GitHub Secrets / AWS Secrets Manager 等 |
| .gitignore設定 | 機密ファイルの除外 |
| 依存関係チェック | Dependabot / npm audit 設定 |

### 6.3 生成されるファイル

```
{project}/
├── .env.example         # 環境変数テンプレート
├── .gitignore           # 機密ファイル除外設定
└── docs/
    └── security/
        ├── secrets-management.md    # シークレット管理手順
        └── security-checklist.md    # セキュリティチェックリスト
```

### 6.4 .env.example テンプレート

```bash
# アプリケーション設定
APP_NAME=
APP_ENV=local
APP_DEBUG=true
APP_URL=http://localhost

# データベース設定
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=
DB_USERNAME=
DB_PASSWORD=

# 外部サービス（本番値は GitHub Secrets 等で管理）
API_KEY=
SECRET_KEY=
```

### 6.5 セキュリティチェックリスト

| チェック項目 | 確認 |
|-------------|------|
| .env が .gitignore に含まれている | □ |
| 本番の認証情報がコードに含まれていない | □ |
| GitHub Secrets に機密情報を登録済み | □ |
| Dependabot が有効になっている | □ |
| HTTPS が有効（本番環境） | □ |

---

## 7. Confluence連携

### 7.1 スペース作成

新プロジェクト用のConfluenceスペースを作成します。

#### スペース情報

| 項目 | 内容 |
|------|------|
| スペースキー | プロジェクトの略称（大文字英数字） |
| スペース名 | プロジェクト正式名称 |
| 説明 | プロジェクトの概要 |

### 7.2 標準フォルダ構成

以下のフォルダ構成をスペース内に作成します：

```
{プロジェクト名}スペース/
├── 📁 01_プロジェクト概要/
│   ├── プロジェクト概要
│   ├── 体制図
│   └── スケジュール
├── 📁 02_要件定義/
│   ├── 機能要件
│   ├── 非機能要件
│   └── 画面一覧
├── 📁 03_設計/
│   ├── アーキテクチャ設計
│   ├── DB設計
│   ├── API設計
│   └── 画面設計
├── 📁 04_開発/
│   ├── 環境構築手順
│   ├── コーディング規約
│   └── 開発ガイド
├── 📁 05_テスト/
│   ├── テスト計画
│   ├── テストケース
│   └── テスト結果
├── 📁 06_運用/
│   ├── 運用手順書
│   ├── 障害対応手順
│   └── 監視設定
├── 📁 07_議事録/
│   └── （日付_議題形式で追加）
└── 📁 08_その他/
    └── 参考資料
```

### 7.3 初期ドキュメントのアップロード

プロジェクト開始時に以下をアップロードします：

| ドキュメント | 配置先 | 内容 |
|-------------|--------|------|
| プロジェクト概要 | 01_プロジェクト概要 | 目的、スコープ、体制 |
| 技術選定結果 | 03_設計 | 選定理由含む |
| 環境構築手順 | 04_開発 | ローカル環境のセットアップ |
| コーディング規約 | 04_開発 | プロジェクト固有ルール |

### 7.4 Confluence操作（MCP経由）

Confluence MCPが設定されている場合：

```
# スペース作成
/agent-infra-jira Confluenceにプロジェクト用スペースを作成してください

# ドキュメントアップロード
/agent-doc-manager 仕様書をConfluenceにアップしてください
```

---

## 8. 開発開始

### 8.1 チェックリスト

開発開始前に以下を確認します：

- [ ] GitHubリポジトリ作成完了
- [ ] CLAUDE.md カスタマイズ完了
- [ ] 要件定義完了
- [ ] 技術選定完了
- [ ] コーディング規約決定
- [ ] テスト規約決定
- [ ] Git運用ルール決定
- [ ] 環境構築完了
- [ ] CI/CD設定完了（必要な場合）
- [ ] セキュリティ設定完了（必要な場合）
- [ ] Confluenceスペース作成完了（必要な場合）
- [ ] 初期ドキュメントアップロード完了

### 8.2 開発キックオフ

```
/agent-infra-init プロジェクトの初期設定を行ってください
```

以下が自動的に設定されます：
- 必要なMCPの有効化
- 初期ディレクトリ構成の作成
- 基本ファイルの生成

### 8.3 最初のタスク

```
# 機能開発開始
/agent-dev-code {最初の機能}を実装してください

# 作業履歴の記録
/agent-meta-history 本日の作業を記録してください
```

---

## 付録

### A. プロジェクトレジストリへの登録

テンプレート適用プロジェクトは登録管理します：

```
/agent-meta-template 新プロジェクト{プロジェクト名}をレジストリに登録してください
```

### B. テンプレート更新の同期

テンプレートが更新された場合：

```
/agent-meta-template テンプレートの更新を同期してください
```

### C. 関連ドキュメント

- [プロジェクトガイドライン](./project-guidelines.md)
- [エージェント・コマンドガイド](./agent-command-guide.md)
- [エージェントカタログ](../catalogs/agent-catalog.md)

---

## 更新履歴

| 日付 | バージョン | 内容 |
|------|-----------|------|
| 2026-01-10 | 1.0.0 | 初版作成 |
| 2026-01-10 | 1.1.0 | 環境構築、CI/CD設定、セキュリティ設定を追加 |

# プロジェクトガイドライン

このテンプレートを使用するプロジェクトの運用ルールです。

## ディレクトリ構成

### プロジェクト配置

```
C:\noguchi\system\projects\
├── project-template\     # テンプレートリポジトリ（マスター）
├── {project-a}\          # 各プロジェクト
├── {project-b}\
└── ...

C:\noguchi\system\docker\
├── {project-a}\          # Docker設定
├── {project-b}\
└── ...
```

### プロジェクト内構成

```
{project}\
├── .claude\              # Claude Code設定（テンプレートからコピー）
│   ├── agents\
│   ├── commands\
│   ├── skills\
│   ├── mcp\
│   └── docs\
├── src\                  # ソースコード（言語により異なる）
├── tests\                # テストコード
├── docs\                 # プロジェクトドキュメント
├── work\                 # 作業ファイル
│   └── 作業履歴\
├── CLAUDE.md             # プロジェクト固有の指示
└── README.md
```

## CLAUDE.mdの書き方

プロジェクトルートの`CLAUDE.md`には、プロジェクト固有の情報を記載します。

### 必須セクション

```markdown
# CLAUDE.md

## プロジェクト概要
プロジェクトの目的と概要

## アーキテクチャ
技術スタック、構成の説明

## 開発環境
環境構築手順、必要なツール

## 開発ルール
プロジェクト固有のコーディング規約
```

### 推奨セクション

```markdown
## ディレクトリ構造
重要なディレクトリの説明

## API/エンドポイント
主要なAPIの一覧

## データベース
テーブル構成、ER図への参照

## テスト
テスト実行方法、カバレッジ基準

## デプロイ
デプロイ手順、環境情報
```

## 作業履歴の管理

### 記録タイミング

- 機能実装完了時
- バグ修正完了時
- 重要な設計判断時
- 問題解決時

### 記録方法

```
/agent-meta-history 本日の認証機能実装作業を記録してください
```

### ファイル配置

```
work/作業履歴/
├── エージェント/         # メインエージェントの履歴
│   ├── 2026-01-10_認証機能実装.md
│   └── ...
└── サブエージェント/     # サブエージェントの履歴
    ├── code-developer/
    ├── test-manager/
    └── ...
```

## Git運用

### ブランチ戦略

```
main (master)
  └── develop
       ├── feature/{feature-name}
       ├── bugfix/{bug-name}
       └── hotfix/{hotfix-name}
```

### コミットメッセージ

Conventional Commits形式を使用：

```
feat: ユーザー認証機能を追加
fix: ログイン時のバリデーションエラーを修正
docs: README.mdを更新
refactor: AuthServiceをリファクタリング
test: ログイン機能のテストを追加
```

### PRテンプレート

```markdown
## 概要
変更内容の説明

## 変更種別
- [ ] 新機能
- [ ] バグ修正
- [ ] リファクタリング
- [ ] ドキュメント

## テスト
テスト方法と結果

## チェックリスト
- [ ] コードレビュー完了
- [ ] テスト通過
- [ ] ドキュメント更新
```

## テンプレート同期

### 定期同期

テンプレートが更新されたら、各プロジェクトに同期します。

```
/agent-meta-template テンプレートの更新を全プロジェクトに同期してください
```

### 同期対象

| 対象 | 同期 | 備考 |
|------|------|------|
| .claude/agents/ | ○ | 全エージェント定義 |
| .claude/commands/ | ○ | 全コマンド |
| .claude/skills/ | ○ | 全スキル |
| .claude/mcp/templates/ | ○ | MCPテンプレート |
| .claude/docs/ | ○ | project-registry.md除く |
| .claude/mcp.json | × | プロジェクト固有 |
| CLAUDE.md | × | プロジェクト固有 |

### プロジェクト固有のカスタマイズ

プロジェクト固有のエージェントやスキルは、同期時にマージされます。
競合がある場合は手動で解決してください。

## セキュリティ

### 認証情報の管理

- APIキー、トークンは環境変数で管理
- `.env`ファイルは`.gitignore`に追加
- 本番環境の認証情報は別途管理

### コード品質

- OWASP Top 10を意識
- SQLインジェクション対策
- XSS対策
- 入力値バリデーション

## 問題発生時

### デバッグ手順

1. `/agent-analyze-debug` で原因調査
2. ログ・エラーメッセージを確認
3. 再現手順を特定
4. 修正・テスト

### エスカレーション

解決できない場合は作業履歴に記録し、次回セッションで継続。

```
/agent-meta-history 未解決の問題を記録してください：{問題の詳細}
```

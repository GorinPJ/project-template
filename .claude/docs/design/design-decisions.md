# 設計決定

このテンプレートの設計判断と理由を記録します。

## DD-001: エージェント数の統合（24→16）

**日付**: 2026-01-10
**ステータス**: 決定済み

### 背景
当初24個のエージェントを計画したが、役割の重複が見られた。

### 決定
16個に統合し、各エージェントの責務を明確化。

### 統合内容

| 統合前 | 統合後 | 理由 |
|--------|--------|------|
| pattern-developer | code-developer | 機能実装は同じ責務 |
| test-spec-generator | test-manager | テスト関連を一元化 |
| test-result-generator | test-manager | 同上 |
| e2e-test-generator | test-manager | 同上 |
| defect-analyzer | debug-analyzer | バグ分析を一元化 |
| spec-document-generator | doc-manager | ドキュメント管理を一元化 |
| agent-catalog-manager | doc-manager | カタログもドキュメントの一部 |

### 理由
- 役割の重複を排除
- 保守性の向上
- 学習コストの削減

---

## DD-002: スキルとエージェントの分離

**日付**: 2026-01-10
**ステータス**: 決定済み

### 背景
ルールの自動適用と明示的なタスク実行を区別する必要があった。

### 決定
- **スキル**: 自動適用されるルール・ガイドライン
- **エージェント**: 明示的に呼び出すタスク実行者

### 例

| 種別 | 名称 | 動作 |
|------|------|------|
| スキル | coding-standards | コード生成時に自動適用 |
| エージェント | code-developer | 「実装して」と指示して実行 |

### 理由
- ルールの一貫した適用を保証
- タスク実行の柔軟性を確保
- 責務の明確な分離

---

## DD-003: テンプレート同期機能の設計

**日付**: 2026-01-10
**ステータス**: 決定済み

### 背景
複数プロジェクトでテンプレートを共有し、更新を反映する仕組みが必要。

### 決定
- template-managerエージェントによる同期管理
- project-registry.mdでプロジェクトを追跡
- CHANGELOGでバージョン管理

### 同期対象

| 対象 | 同期 | 理由 |
|------|------|------|
| agents/ | ○ | 共通機能 |
| commands/ | ○ | 共通機能 |
| skills/ | ○ | 共通ルール |
| mcp/templates/ | ○ | 参照用 |
| mcp.json | × | プロジェクト固有 |
| CLAUDE.md | × | プロジェクト固有 |

### 理由
- 共通部分の一元管理
- プロジェクト固有設定の保護
- 更新追跡の容易さ

---

## DD-004: MCPカタログ方式の採用

**日付**: 2026-01-10
**ステータス**: 決定済み

### 背景
MCPの設定を効率的に管理する方法が必要。

### 選択肢
A. カタログのみ（ドキュメント）
B. テンプレートのみ（JSONファイル）
C. カタログ + テンプレート（両方）

### 決定
C. カタログ + テンプレート

### 構成
```
.claude/mcp/
├── mcp.json.example      # 設定例
└── templates/            # 各MCP設定テンプレート
    ├── atlassian.json
    └── ...

.claude/docs/catalogs/
└── mcp-catalog.md        # 一覧・説明
```

### 理由
- カタログで概要を把握
- テンプレートでコピペ可能
- 両方のニーズに対応

---

## DD-005: カスタムコマンド命名規則

**日付**: 2026-01-10
**ステータス**: 決定済み

### 背景
エージェント呼び出しコマンドの命名規則が必要。

### 決定
`/agent-{カテゴリ}-{名前}` 形式を採用。

### 例
| エージェント | コマンド |
|------------|---------|
| code-developer | /agent-dev-code |
| test-manager | /agent-test-manager |
| git-workflow-manager | /agent-infra-git |

### カテゴリ略称
| カテゴリ | 略称 |
|---------|------|
| meta | meta |
| document | doc |
| development | dev |
| test | test |
| analysis | analyze |
| infrastructure | infra |

### 理由
- 一貫性のある命名
- カテゴリによるグルーピング
- 入力しやすい長さ

---

## DD-006: 作業履歴の配置

**日付**: 2026-01-10
**ステータス**: 決定済み

### 背景
作業履歴ファイルの配置場所を決定する必要があった。

### 決定
`work/作業履歴/` に配置。

```
work/作業履歴/
├── エージェント/         # メインエージェントの履歴
└── サブエージェント/     # サブエージェント別の履歴
```

### 理由
- `.claude/` はテンプレート管理用
- `work/` は作業ファイル用
- プロジェクト固有データとして管理
